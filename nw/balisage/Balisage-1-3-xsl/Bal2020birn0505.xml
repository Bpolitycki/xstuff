<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="balisage-1-3.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-stylesheet type="text/xsl" href="balisage-proceedings-html.xsl"?>
<article xmlns="http://docbook.org/ns/docbook">
    <title>Sequence alignment in XSLT 3.0</title>
    <info>
        <abstract>
            <para>Abstract goes here</para>
        </abstract>
        <author>
            <personname>
                <firstname>David</firstname>
                <othername>J.</othername>
                <surname>Birnbaum</surname>
            </personname>
            <personblurb>
                <para>David J. Birnbaum is Professor and Chair of the Department of Slavic Languages
                    and Literatures at the University of Pittsburgh. He has been involved in the
                    study of electronic text technology since the mid-1980s, has delivered
                    presentations at a variety of electronic text technology conferences, and has
                    served on the board of the Association for Computers and the Humanities, the
                    editorial board of <emphasis role="ital">Markup languages: theory and
                        practice</emphasis>, and the Text Encoding Initiative Technical Council.
                    Much of his electronic text work intersects with his research in medieval Slavic
                    manuscript studies, but he also often writes about issues in the philosophy of
                    markup.</para>
            </personblurb>
            <affiliation>
                <jobtitle>Professor</jobtitle>
                <orgname>Department of Slavic Languages and Literatures, University of Pittsburgh
                    (US)</orgname>
            </affiliation>
            <email>djbpitt@gmail.com</email>
            <link>http://www.obdurodon.org</link>
        </author>
    </info>
    <section>
        <title>Introduction</title>
        <section>
            <title>Why sequence aligment matters</title>
            <para>Why sequence alignment matters, especially in humanities (and, opportunistically,
                in biology)</para>
        </section>
        <section>
            <title>Biological and textual alignment</title>
            <para>Insofar as biomedical research enjoys a larger scientific community and richer
                funding resources than textual humanities scholarship, it is not surprising that the
                literature, and the science reported in that literature, is quantitatively greater
                in the natural sciences than in the humanities. Insofar as all sequence alignment is
                similar in certain ways, it is both necessary and appropriate for textual scholars
                to seek opportunities to adapt biomedical methods for their own purposes. It is
                nonetheless the case that there are key differences in the shape of alignment
                problems in biomedical contexts, on the one hand, and in textual contexts, on the
                other. These include: <itemizedlist>
                    <listitem>
                        <para>Genetic alignment may operate at sequence lengths involving entire
                            chromosomes or entire genomes, which is orders of magnitude larger than
                            the largest textual alignment task.</para>
                    </listitem>
                    <listitem>
                        <para>Genetic alignment often operates with a vocabulary of four words,
                            while textual alignment often involves a vocabulary of hundreds or
                            thousands of different words or more.</para>
                    </listitem>
                </itemizedlist></para>
            <para>Despite the ways in which biological and textual alignment are similar tasks, the
                preceding systematic differences in size and scale invite exploring the consequences
                of these differences in the source data. Especially in the case of heuristic
                approaches that are not guaranteed to produce an optimal solution, is it possible
                that compromises required to make data at large scale computationally tractable
                might profitably be avoided in domains involving data ot a substantially smaller
                scale?</para>
        </section>
        <section>
            <title>Global pairwise alignment</title>
            <para>The following two distinctions—not between genetic and textual alignment, but
                within both domains—are also relevant:<itemizedlist>
                    <listitem>
                        <para>Both genetic and textual alignment tasks can be divided into <emphasis
                                role="ital">global</emphasis> and <emphasis role="ital"
                                >local</emphasis> alignment. The goal of global alignment is to find
                            the best alignment of all items in the entire sequences. In textual
                            scholarship this is often called <emphasis role="ital"
                                >collation</emphasis> (cf. e.g., <xref linkend="fv_reader"/>). The
                            goal of local alignment is to find moment where sequences correspond,
                            without attempting to optimize the alignment of the entire sequences. A
                            common textual use for local alignment is <emphasis role="ital">text
                                reuse</emphasis>, e.g., finding moments where Dante quotes or
                            paraphrases Ovid (cf. <xref linkend="peteghhem_2015"/>, <xref
                                linkend="intertextual_dante"/>).</para>
                    </listitem>
                    <listitem>
                        <para>Both genetic and textual alignment tasks may involve <emphasis
                                role="ital">pairwise alignment</emphasis> or <emphasis role="ital"
                                >multiple alignment</emphasis>. Pairwise alignment refers to the
                            alignment of two sequences; multiple alignment refers to the alignment
                            of more than two sequences. In textual scholarship multiple alignment is
                            often called <emphasis role="ital">multiple witness
                            alignment</emphasis>.</para>
                    </listitem>
                </itemizedlist></para>
            <para>The Needleman Wunsch algorithm described and implemented below has been proven to
                identify all optimal global, pairwise alignments of two sequences. The present
                report does not address either local alignment or multiple (witness)
                alignment.</para>
        </section>
    </section>
    <section>
        <title>About sequence alignment</title>
        <para>Description of the task</para>
    </section>
    <section>
        <title>Dynamic programming</title>
        <para>Dynamic programming and Needleman Wunsch. See <xref linkend="snip"/> for a walk-through.<note>
                <blockquote>
                    <para>We will begin with the scoring system most commonly used when introducing
                        the Needleman-Wunsch algorithm: substitution scores for matched residues and
                        linear gap penalties. Although Needleman and Wunsch already discussed this
                        scoring system in their 1970 article [NW70], the form in which it is now
                        most commonly presented is due to Gotoh [Got82] (who is also responsible for
                        the affine gap penalties version of the algorithm). An alignment algorithm
                        very similar to Needleman-Wunsch, but developed for speech recognition, was
                        also independently described by Vintsyuk in 1968 [Vin68]. Another early
                        author interested in the subject is Sellers [Sel74], who described in 1974
                        an alignment algorithm minimizing sequence distance rather than maximizing
                        sequence similarity; however Smith and Waterman (two authors famous for the
                        algorithm bearing their name) proved in 1981 that both procedures are
                        equivalent [SWF81]. Therefore it is clear that there are many classic
                        papers, often a bit old, describing Needleman-Wunsch and its variants using
                        different mathematical notations. [<xref linkend="boes_2014"/>, 14; pointers
                        are to <xref linkend="needleman_1970"/>, <xref linkend="gotoh_1982"/>, <xref
                            linkend="vintsyuk_1968"/>, <xref linkend="sellers_1974"/>, and <xref
                            linkend="smith_1981"/>]</para>
                </blockquote>
            </note>
            <!-- --></para>
        <para>Needleman Wunsch <quote>is an <emphasis role="ital">optimal</emphasis> algorithm,
                which means that it produces the best possible solution with respect to the chosen
                scoring system. There exists also non-optimal alignment algorithms, most notably the
                heuristic methods …</quote> [<xref linkend="boes_2014"/>, 13]</para>
    </section>
    <section>
        <title>Sequence alignment and XSLT</title>
        <para>Why XSLT plays poorly with dynamic programming</para>
        <para>Why for-each doesn’t work</para>
        <para>Why recursion breaks</para>
        <para>Iteration to the rescue</para>
        <para>Thinking in XSLT. Simplifyiing assumption: only one best path, even if there are more
            than one.</para>
    </section>
    <section>
        <title>Inching toward XSLT-idiomatic alignment</title>
        <section>
            <title>A naive approach</title>
            <para>Build the whole grid using iterate, then walk backwards using recursion</para>
        </section>
        <section>
            <title>Save yourself a trip</title>
            <para>Record the full path in each cell to avoid having to walk back</para>
        </section>
        <section>
            <title>Using the diagonal</title>
            <para>Jeni (<xref linkend="tennison_2007"/>) uses it to reduce recursion; for-each over
                each diagonal, so recur only for new diagonal</para>
            <para>for-each allows parallel processing (<xref linkend="wong_2002"/>, <xref
                    linkend="naveed_2005"/>), although we can’t guarantee it because XSLT doesn’t
                give the programmer explicit control over parallelization (cf. Python). Saxon EE
                supports parallel processing of <code>xsl:for-each</code> with the optional
                    <code>@saxon:threads</code> attribute. [<xref linkend="saxon_for-each"/>]<note>
                    <para><blockquote>
                            <para>Processing using multiple threads can take advantage of multi-core
                                CPUs. However, there is an overhead, in that the results of
                                processing each item in the input need to be buffered. The overhead
                                of coordinating multiple threads is proportionally higher if the
                                per-item processing cost is low, while the overhead of buffering is
                                proportionally higher if the amount of data produced when each item
                                is processed is high. Multi-threading therefore works best when the
                                body of the xsl:for-each instruction performs a large amount of
                                computation but produces a small amount of output.</para>
                        </blockquote> [<xref linkend="saxon_threads"/>]</para>
                </note></para>
        </section>
        <section>
            <title>Conclusions</title>
            <para>Say something</para>
        </section>
    </section>
    <bibliography>
        <title>Works cited</title>
        <bibliomixed xml:id="bellman_1952" xreflabel="Bellman 1952">Bellman, Richard E. 1952.
                <quote>On the theory of dynamic programming.</quote>
            <emphasis role="ital">Proceedings of the National Academy of Sciences</emphasis>
            38(8):716–19.
            <link>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1063639/</link></bibliomixed>
        <bibliomixed xml:id="bellman_1954" xreflabel="Bellman 1954">Bellman, Richard E. <quote>The
                theory of dynamic programming.</quote> Technical report P-550. Santa Monica: Rand
            Corporation. <link>http://smo.sogang.ac.kr/doc/bellman.pdf</link></bibliomixed>
        <bibliomixed xml:id="boes_2014" xreflabel="Boes 2014">Boes, Olivier. 2014. <quote>Improving
                the Needleman-Wunsch algorithm with the DynaMine predictor.</quote> Master in
            Bioinformatics thesis, Université lire de Bruxelles.</bibliomixed>
        <bibliomixed xml:id="snip" xreflabel="Snipacademy Global alignment"><quote>Global alignment.
                Needleman-Wunsch.</quote> Chapter 9 of Pairwise alignment, Bioinformatics Lessons at
            your convenience, Snipacademy.
                <link>https://binf.snipcademy.com/lessons/pairwise-alignment/global-needleman-wunsch</link></bibliomixed>
        <bibliomixed xml:id="gotoh_1982" xreflabel="Gotoh 1982">Gotoh, Osamu. 1982. <quote>An
                improved algorithm for matching biological sequences.</quote>
            <emphasis role="ital">Journal of molecular biology</emphasis>
            162(3):705–08.</bibliomixed>
        <bibliomixed xml:id="intertextual_dante" xreflabel="Intertextual Dante"><quote>Intertextual
                Dante.</quote>
            <link>https://digitaldante.columbia.edu/intertexual-dante-vanpeteghem/</link></bibliomixed>
        <bibliomixed xml:id="fv_reader" xreflabel="Frankenstein variorum reader"><quote>Mary
                Shelley’s Frankenstein. A digital variorum edition.</quote>
            <link>http://frankensteinvariorum.library.cmu.edu/viewer/</link>. See also the project
            GitHub repo at <link>https://github.com/FrankensteinVariorum/</link>.</bibliomixed>
        <bibliomixed xml:id="needleman_1970" xreflabel="Needleman and Wunsch 1970">Needleman, Saul
            B. and Christian D. Wunsch. 1970. <quote>A general method applicable to the search for
                similarities in the amino acid sequence of two proteins.</quote>
            <emphasis role="ital">Journal of molecular biology</emphasis> 48 (3): 443–53.
            doi:10.1016/0022-2836(70)90057-4.</bibliomixed>
        <bibliomixed xml:id="naveed_2005" xreflabel="Naveed et al, 2005">Naveed, Tahir,Imitaz Saeed
            Siddiqui, Shaftab Ahmed. 2005. <quote>Parallel Needleman-Wunsch algorithm for
                grid.</quote> Proceedings of the PAK-US International Symposium on High Capacity
            Optical Networks and Enabling Technologies (HONET 2005), Islamabad, Pakistan, Dec 19–21,
            2005.
                <link>https://upload.wikimedia.org/wikipedia/en/c/c4/ParallelNeedlemanAlgorithm.pdf</link></bibliomixed>
        <bibliomixed xml:id="sankoff_1972" xreflabel="Sankoff 1972">Sankoff David. 1972.
                <quote>Matching sequences under deletion/insertion constraints.</quote>
            <emphasis role="ital">Proceedings of the National Academy of Sciences of the
                USA</emphasis> 69 (1): 4–6. doi:10.1073/pnas.69.1.4.
                <link>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC427531/pdf/pnas00127-0010.pdf</link></bibliomixed>
        <bibliomixed xml:id="saxon_for-each" xreflabel="Saxon xsl:for-each">Saxon documentation of
                <emphasis role="ital">xsl:for-each</emphasis>.
                <link>https://www.saxonica.com/html/documentation/xsl-elements/for-each.html</link></bibliomixed>
        <bibliomixed xml:id="saxon_threads" xreflabel="Saxon saxon:threads">Saxon documentation of
                <emphasis role="ital">saxon:threads</emphasis>.
                <link>https://www.saxonica.com/html/documentation/extensions/attributes/threads.html</link></bibliomixed>
        <bibliomixed xml:id="sellers_1974" xreflabel="Sellers 1974">Sellers, Peter H. 1974.
                <quote>On the theory and computation of evolutionary distances.</quote>
            <emphasis role="ital">SIAM journal on applied mathematics</emphasis>
            26(4):787–93.</bibliomixed>
        <bibliomixed xml:id="smith_1981" xreflabel="Smith et al. 1981">Smith, Temple F., Michael S.
            Waterman, and Walter M. Fitch. 1981. <quote>Comparative biosequence metrics.</quote>
            <emphasis role="ital">Journal of molecular evolution</emphasis>,
            18(1):38–46.</bibliomixed>
        <bibliomixed xml:id="tennison_2007" xreflabel="Tennison 2007">Tennison, Jeni. 2007.
                <quote>Levenshtein distance on the diagonal</quote> Posted to <emphasis role="ital"
                >Jeni’s musings</emphasis>, 2007-05-06.
                <link>https://www.jenitennison.com/2007/05/06/levenshtein-distance-on-the-diagonal.html</link></bibliomixed>
        <bibliomixed xml:id="peteghhem_2015" xreflabel="Van Peteghem 2015">Van Peteghem, Julie.
            2015. <quote>Digital readers of allusive texts: Ovidian intertextuality in the Commedia
                and the Digital concordance on intertextual Dante.</quote>
            <emphasis role="ital">Humanist studies &amp; the digital age</emphasis>, 4.1, 39–59.
            DOI: 10.5399/uo/hsda.4.1.3584.
                <link>http://journals.oregondigital.org/index.php/hsda/article/view/3584</link></bibliomixed>
        <bibliomixed xml:id="vintsyuk_1968" xreflabel="Vintsyuk 1968">Vintsyuk, T[aras] K[lymovych].
            1968. <quote>Speech discrimination by dynamic programming.</quote>
            <emphasis role="ital">Cybernetics</emphasis> 4(1):52–57.</bibliomixed>
        <bibliomixed xml:id="wong_2002" xreflabel="Wong 2002">Wang, Bin. 2002. <quote>Implementation
                of a dynamic programming algorithm for DNA sequence alignment on the cell matrix
                architecture. MA thesis, Utah State University.</quote>
            <link>https://www.cellmatrix.com/entryway/products/pub/wang2002.pdf</link></bibliomixed>
    </bibliography>
</article>
